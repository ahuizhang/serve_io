(this["webpackJsonpsocket-io"]=this["webpackJsonpsocket-io"]||[]).push([[0],{185:function(e,t,a){},275:function(e,t,a){},310:function(e,t,a){"use strict";a.r(t);var c=a(0),s=a.n(c),n=a(25),r=a.n(n),i=(a(185),a(121)),o=a(24),l=a(127),j=a(61),u=a(313),d=a(175),b=a(314),m=a(315),h=a(173),f=a(55),O=a.n(f),x=a(9);function g(){var e=u.a.TabPane,t=Object(c.useState)(!0),a=Object(j.a)(t,2),s=a[0],n=a[1];return Object(x.jsx)("div",{className:"badyHome",children:Object(x.jsx)("div",{className:"login_container",children:Object(x.jsxs)(u.a,{defaultActiveKey:"1",onChange:function(e){switch(e){case"1":n(!0);break;case"2":n(!1)}},children:[Object(x.jsx)(e,{tab:"\u767b\u5165",children:Object(x.jsx)(p,{isLogin:s})},"1"),Object(x.jsx)(e,{tab:"\u6ce8\u518c",children:Object(x.jsx)(p,{isLogin:s})},"2")]})})})}function p(e){var t=Object(o.f)();return Object(x.jsxs)(b.a,Object(l.a)(Object(l.a)({},{labelCol:{span:6}}),{},{name:"login",onFinish:function(a){if(e.isLogin)O.a.post("/user/login",a).then((function(e){e.data&&0===e.data.code?(d.b.success(e.data.msg),localStorage.setItem("id",e.data.uid),t.push("/chatroom")):d.b.success(e.data.msg)})).catch((function(e){d.b.error(e)}));else{if(a.password!==a.confirmPassword)return;O.a.post("/user/register",{username:a.username,password:a.password}).then((function(e){e.data&&0===e.data.code?(d.b.success(e.data.msg),localStorage.setItem("id",e.data.uid),t.push("/chatroom")):d.b.success(e.data.msg)})).catch((function(e){d.b.error(e)}))}},children:[Object(x.jsx)(b.a.Item,{label:"\u8d26\u53f7",name:"username",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d26\u53f7!"}],children:Object(x.jsx)(m.a,{})}),Object(x.jsx)(b.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"}],children:Object(x.jsx)(m.a.Password,{})}),e.isLogin?null:Object(x.jsx)(b.a.Item,{label:"\u786e\u8ba4\u5bc6\u7801",name:"confirmPassword",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u786e\u8ba4\u5bc6\u7801!"}],children:Object(x.jsx)(m.a.Password,{})}),Object(x.jsx)(b.a.Item,{children:Object(x.jsx)(h.a,{type:"primary",htmlType:"submit",block:!0,children:e.isLogin?"\u767b\u5165":"\u6ce8\u518c"})})]}))}O.a.defaults.baseURL="http://180.188.198.117:3001";var v=a(174),I=a(86),N=a.n(I),w=a(125),y=(a(275),a(168)),L=a.n(y),S=a(312),k=a(316),C=a.p+"static/media/leftAvatar.690ea669.jfif",T=a.p+"static/media/rightAvatar.708ac5b1.jpg";O.a.defaults.baseURL="http://180.188.198.117:3001";var R=L()();function _(){return Object(x.jsxs)("div",{className:"chatRoomContailter",children:[Object(x.jsx)(q,{}),Object(x.jsx)(D,{})]})}function q(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),a=t[0],s=t[1],n=localStorage.getItem("id"),r=Object(c.useState)(localStorage.getItem("otherID")),i=Object(j.a)(r,2),o=i[0],l=i[1];Object(c.useEffect)((function(){function e(){return(e=Object(w.a)(N.a.mark((function e(){var t;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/user/list");case 2:t=e.sent,s(t.data.userList);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);return Object(x.jsx)("div",{className:"userList",children:a.length>0&&Object(x.jsx)(S.b,{itemLayout:"horizontal",dataSource:a,renderItem:function(e){if(n!==e._id)return Object(x.jsx)(S.b.Item,{onClick:function(){return t=e._id,localStorage.setItem("otherID",t),void l(t);var t},style:{background:o===e._id?"aqua":"#fff"},children:Object(x.jsx)(S.b.Item.Meta,{avatar:Object(x.jsx)(k.a,{src:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"}),title:e.username,description:"\u4e2a\u6027\u7b7e\u540d"})})}})})}function D(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),a=t[0],s=t[1],n=Object(c.useState)(""),r=Object(j.a)(n,2),i=r[0],o=r[1],l=localStorage.getItem("otherID"),u=localStorage.getItem("id");Object(c.useEffect)((function(){function e(){return(e=Object(w.a)(N.a.mark((function e(){var t,a;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get("/user/getMagsList");case 2:t=e.sent,a=t.data.magsList.filter((function(e){return e.chatID===l+"_"+u})),s(a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[u,l]),Object(c.useEffect)((function(){R.on("globalMsg",(function(e){s([].concat(Object(v.a)(a),[e]))}))}));return l&&Object(x.jsxs)("div",{className:"chatRightList",children:[Object(x.jsx)("div",{className:"chatContent",children:a.length>0&&a.map((function(e){return e.from!==u?Object(x.jsxs)("div",{className:"chatLeft",children:[Object(x.jsx)("img",{src:C,alt:""}),Object(x.jsxs)("div",{className:"leftText",children:[Object(x.jsx)("span",{className:"leftTitle",children:"tom"}),Object(x.jsx)("span",{className:"leftTx",children:e.content})]})]},e._id):Object(x.jsxs)("div",{className:"chatRight",children:[Object(x.jsx)("img",{src:T,alt:""}),Object(x.jsxs)("div",{className:"rightText",children:[Object(x.jsx)("span",{className:"rightTitle",children:"terr"}),Object(x.jsx)("span",{className:"RightText",children:e.content})]})]},e._id)}))}),Object(x.jsxs)("div",{className:"chatRoomFooter",children:[Object(x.jsx)(h.a,{type:"primary",className:"chatSendButton",onClick:function(){if(""===i.trim())return d.b.info("\u5185\u5bb9\u7a7a");R.emit("sendMsg",{msg:i,to:l,from:u}),o("")},children:"\u53d1\u9001"}),Object(x.jsx)(m.a,{className:"chatSendContent",placeholder:"\u8bf7\u8f93\u5165\u5185\u5bb9......",value:i,onChange:function(e){e.target.value&&o(e.target.value)}})]})]})}function P(){return Object(x.jsx)(i.a,{children:Object(x.jsxs)(o.c,{children:[Object(x.jsx)(o.a,{path:"/",exact:!0,component:g}),Object(x.jsx)(o.a,{path:"/chatroom",component:_})]})})}r.a.render(Object(x.jsx)(s.a.Fragment,{children:Object(x.jsx)(P,{})}),document.getElementById("root"))}},[[310,1,2]]]);
//# sourceMappingURL=main.69550099.chunk.js.map